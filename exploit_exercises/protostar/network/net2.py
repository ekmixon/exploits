#!/usr/bin/env python
import sys, socket
from struct import pack, unpack
from binascii import hexlify

HOST = sys.argv[1]
PORT = 2997
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT))

sum = 0

for i in range(4):
    data = s.recv(4)                    # receive data

    print "[*] Input: %s (%s)" % (data, hexlify(data))    
    value = unpack("<I",data)[0]        # little endian
    sum += value

sum = sum & 0xffffffff
print "[*] Sum: %d (%x)" % (sum, sum)
sum = pack("<I",sum)                    # little endian
s.sendall(sum)                          # send data back

data = s.recv(1024)
print "%s" % data               # print the confirmation

s.close()
