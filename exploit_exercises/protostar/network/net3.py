#!/usr/bin/env python
import sys, socket
from struct import pack, unpack
from binascii import hexlify

HOST = sys.argv[1]
PORT = 2996
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT))

resource = "net3"
resource = pack("B",len(resource)+1) + resource + "\x00"

user = "awesomesauce"
user = pack("B",len(user)+1) + user + "\x00"

password = "password"
password = pack("B",len(password)+1) + password + "\x00"

auth = "\x17" + resource + user + password        # auth packet
len = pack(">H",len(auth)) # packed in network/big endian order

packet = len + auth
print hexlify(packet)      # print packet in hex

s.sendall(packet)

data = s.recv(1024)
print "%s" % data          # print the confirmation

s.close()
