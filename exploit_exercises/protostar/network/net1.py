#!/usr/bin/env python
import sys, socket
from struct import pack
from binascii import hexlify

HOST = sys.argv[1]
PORT = 2998
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT))

data = s.recv(1024)                 # receive data
print "[*] Input: %s (%s)" % (data, hexlify(data))


value = int( hexlify(data) , 16)    # convert to int

value = pack("<I", value)           # little endian
value = int( hexlify(value) , 16)   # convert to int

print "[*] Output: %d (%x)" % (value, value)

s.sendall("%d\r\n" % value)         # send data back

data = s.recv(1024)
print "%s" % data      # print the confirmation

s.close()
